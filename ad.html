<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>MovieCove</title>
<style>
body { background:#000; color:#fff; font-family:sans-serif; margin:0; }
header { padding:15px; background:#111; text-align:center; }
#movies { display:flex; flex-wrap:wrap; gap:10px; padding:10px; justify-content:center; }
.movie { width:150px; cursor:pointer; text-align:center; }
.movie img { width:100%; border-radius:6px; }
#player { display:none; position:fixed; inset:0; background:black; }
#player iframe { width:100%; height:90vh; border:none; }
#close { color:white; text-align:center; padding:10px; cursor:pointer; background:#111; }
</style>
</head>
<body>

<header>
<h2>Latest Movies</h2>
</header>

<div id="movies">Loading...</div>

<div id="player">
<div id="close">Close</div>
<iframe id="frame" allowfullscreen></iframe>
</div>

<script>
const API = "https://moviecove-backup-api-1.onrender.com";

async function loadMovies(){
  try{
    const res = await fetch(`${API}/movies/latest/1`);
    const data = await res.json();

    const container = document.getElementById("movies");
    container.innerHTML = "";

    data.forEach(movie=>{
      const div = document.createElement("div");
      div.className = "movie";
      div.innerHTML = `
        <img src="${movie.cover}" />
        <p>${movie.title}</p>
      `;
      div.onclick = () => playMovie(movie.imdb || movie.tmdb);
      container.appendChild(div);
    });

  }catch(err){
    document.getElementById("movies").innerHTML = "Error loading movies";
    console.log(err);
  }
}

function playMovie(id){
  document.getElementById("player").style.display = "block";
  document.getElementById("frame").src =
    `https://vidsrc-embed.ru/embed/movie/${id}?autoplay=1`;
}

document.getElementById("close").onclick = ()=>{
  document.getElementById("player").style.display = "none";
  document.getElementById("frame").src = "";
}

loadMovies();
</script>

</body>
</html>
